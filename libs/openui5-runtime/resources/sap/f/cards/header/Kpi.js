/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/core/Control','sap/ui/core/library','sap/ui/model/json/JSONModel','sap/m/NumericContent','sap/m/ObjectNumber','sap/m/VBox','sap/m/Text','sap/m/Label','sap/f/cards/Data',"sap/f/cards/header/KpiRenderer"],function(C,c,J,N,O,V,T,L,D){"use strict";var a=c.TextAlign;var K=C.extend("sap.f.cards.header.Kpi",{metadata:{properties:{data:{"type":"object"},title:{"type":"string"},subtitle:{"type":"string"},unitOfMeasurement:{"type":"string"},mainIndicator:{"type":"object"},sideIndicators:{"type":"array"},details:{"type":"string"}},aggregations:{_title:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_subtitle:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_unitOfMeasurement:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_mainIndicator:{type:"sap.m.NumericContent",multiple:false,visibility:"hidden"},_sideIndicators:{type:"sap.m.VBox",multiple:true,visibility:"hidden"},_details:{type:"sap.m.Text",multiple:false,visibility:"hidden"}}}});K.prototype.init=function(){this.setModel(new J());};K.prototype._createContent=function(m){if(m.title){this.setAggregation("_title",new T({id:this.getId()+"-title",wrapping:true,maxLines:3,text:m.title}));}if(m.subtitle){this.setAggregation("_subtitle",new T({id:this.getId()+"-subtitle",wrapping:true,maxLines:2,text:m.subtitle}));}if(m.unitOfMeasurement){this.setAggregation("_unitOfMeasurement",new T({id:this.getId()+"-unitOfMeasurement",wrapping:false,text:m.unitOfMeasurement}));}if(m.mainIndicator){this.setAggregation("_mainIndicator",new N({id:this.getId()+"-mainIndicator",withMargin:false,animateTextChange:false,truncateValueTo:5,value:m.mainIndicator.number,scale:m.mainIndicator.unit,indicator:m.mainIndicator.trend,valueColor:m.mainIndicator.state}));}if(m.sideIndicators){m.sideIndicators.forEach(function(i,I){this.addAggregation("_sideIndicators",new V({id:this.getId()+"-sideIndicator"+I,items:[new T({id:this.getId()+"-sideIndicator"+I+"-title",wrapping:false,text:i.title}),new O({id:this.getId()+"-sideIndicator"+I+"-value",textAlign:a.End,emphasized:false,number:i.number,unit:i.unit})]}));}.bind(this));}if(m.details){this.setAggregation("_details",new T({id:this.getId()+"-details",wrapping:false,text:m.details}));}};K.prototype.applySettings=function(s,S){var d=s.data;if(d){this.setData(d);delete s.data;}C.prototype.applySettings.apply(this,[s,S]);s.data=d;this._createContent(s);return this;};K.prototype.setData=function(d){this.setProperty("data",d);if(!d){return this;}var r=d.request;if(d.json&&!r){this._updateModel(d.json,d.path);}if(r){D.fetch(r).then(function(b){this._updateModel(b,d.path);}.bind(this)).catch(function(e){});}return this;};K.prototype._updateModel=function(d,p){this.getModel().setData(d);this.bindElement({path:p||"/"});};return K;});
