/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/unified/calendar/CalendarDate','sap/ui/unified/calendar/CalendarUtils','sap/ui/core/date/UniversalDate','sap/ui/core/InvisibleText','sap/ui/unified/library'],function(C,a,U,I,u){"use strict";var b=u.CalendarDayType;var S={};S.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapMSinglePCGrid");r.addClass("sapUiSizeCompact");r.writeClasses();r.write(">");r.renderControl(c.getAggregation("_columnHeaders"));this.renderBlockersContainer(r,c);r.write("<div");r.addClass("sapMSinglePCGridContent");r.writeClasses();r.write(">");this.renderRowHeaders(r,c);this.renderNowMarker(r,c);this.renderColumns(r,c);r.write("</div>");r.write("</div>");};S.renderBlockersContainer=function(r,c){var d=c._getColumns(),m=c._getBlockersToRender().iMaxlevel,s=c.getStartDate(),e=(m+1)*c._getBlockerRowHeight();r.write("<div");r.addClass("sapMSinglePCBlockersRow");r.writeClasses();r.write(">");r.write("<div");r.addClass("sapMSinglePCBlockersColumns");if(m>0){e=e+3;}r.addStyle("height",e+"px");r.writeClasses();r.writeStyles();r.write(">");for(var i=0;i<d;i++){var o=new C(s.getFullYear(),s.getMonth(),s.getDate()+i),D=c._formatDayAsString(o);r.write("<div");r.writeAttribute("data-sap-day",D);r.addClass("sapMSinglePCBlockersColumn");if(o.isSame(new C())){r.addClass("sapMSinglePCBlockersColumnToday");}if(a._isWeekend(o,c._getCoreLocaleData())){r.addClass("sapMSinglePCBlockersColumnWeekend");}r.writeClasses();r.write(">");r.write("</div>");}this.renderBlockers(r,c);r.write("</div>");r.write("</div>");};S.renderBlockers=function(r,c){var t=this,B=c._getBlockersToRender().oBlockersList;r.write("<div");r.writeAttribute("role","grid");r.writeAttribute("aria-labelledby",I.getStaticId("sap.m","SPC_BLOCKERS"));r.addClass("sapMSinglePCBlockers");r.addClass("sapUiCalendarRowVisFilled");r.writeClasses();r.write(">");B.getIterator().forEach(function(o){t.renderBlockerAppointment(r,c,o);});r.write("</div>");};S.renderBlockerAppointment=function(r,c,B){var g=C.fromLocalJSDate(c.getStartDate()),o=B.getData(),d=C.fromLocalJSDate(o.getStartDate()),e=C.fromLocalJSDate(o.getEndDate()),s=a._daysBetween(d,g),E=a._daysBetween(e,g),i=c._getColumns(),R=c._getBlockerRowHeight(),f=B.level,h=B.width,t=o.getTooltip_AsString(),T=o.getType(),j=o.getColor(),k=o.getTitle(),l=o.getText(),m=o.getIcon(),n=o.getId(),A={role:"gridcell",labelledby:{value:I.getStaticId("sap.ui.unified","APPOINTMENT"),append:true}},p=c.getAriaLabelledBy(),L=s*(100/i),q=(i-E-1)*(100/i),v=sap.ui.getCore().getConfiguration().getRTL(),w;if(p.length>0){A["labelledby"].value=A["labelledby"].value+" "+p.join(" ");}if(k){A["labelledby"].value=A["labelledby"].value+" "+n+"-Title";}A["labelledby"].value=A["labelledby"].value+" "+n+"-Descr";if(l){A["labelledby"].value=A["labelledby"].value+" "+n+"-Text";}if(o.getSelected()){A["labelledby"].value=A["labelledby"].value+" "+I.getStaticId("sap.ui.unified","APPOINTMENT_SELECTED");}if(o.getTentative()){A["labelledby"].value=A["labelledby"].value+" "+I.getStaticId("sap.ui.unified","APPOINTMENT_TENTATIVE");}r.write("<div");r.writeElementData(o);r.writeAttribute("data-sap-level",f);r.writeAttribute("data-sap-width",h);r.writeAttribute("tabindex",0);if(t){r.writeAttributeEscaped("title",t);}r.writeAccessibilityState(o,A);r.addClass("sapMSinglePCAppointmentWrap");r.addClass("sapUiCalendarRowApps");r.addStyle("top",R*f+1+"px");r.addStyle(v?"right":"left",Math.max(L,0)+"%");r.addStyle(v?"left":"right",Math.max(q,0)+"%");r.writeClasses();r.writeStyles();r.write(">");r.write("<div");r.addClass("sapUiCalendarApp");if(o.getSelected()){r.addClass("sapUiCalendarAppSel");}if(o.getTentative()){r.addClass("sapUiCalendarAppTent");}if(m){r.addClass("sapUiCalendarAppWithIcon");}if(!j&&T&&T!=b.None){r.addClass("sapUiCalendarApp"+T);}if(j){if(sap.ui.getCore().getConfiguration().getRTL()){r.addStyle("border-right-color",j);}else{r.addStyle("border-left-color",j);}}r.writeClasses();r.writeStyles();r.write(">");r.write("<div");r.addClass("sapUiCalendarAppCont");if(j){r.addStyle("background-color",o._getCSSColorForBackground(j));r.writeStyles();}r.writeClasses();r.write(">");if(L<0){w=["sapUiCalendarAppArrowIconLeft","sapUiCalendarAppArrowIcon"];r.writeIcon("sap-icon://arrow-left",w,{title:null});}if(m){w=["sapUiCalendarAppIcon"];var x={};x["id"]=n+"-Icon";x["title"]=null;r.writeIcon(m,w,x);}if(k){r.write("<span");r.writeAttribute("id",n+"-Title");r.addClass("sapUiCalendarAppTitle");r.writeClasses();r.write(">");r.writeEscaped(k,true);r.write("</span>");}if(q<0){w=["sapUiCalendarAppArrowIconRight","sapUiCalendarAppArrowIcon"];r.writeIcon("sap-icon://arrow-right",w,{title:null});}r.write("<span id=\""+n+"-Descr\" class=\"sapUiInvisibleText\">"+c._getAppointmentStartEndInfo(o)+"</span>");r.write("</div>");r.write("</div>");r.write("</div>");};S.renderRowHeaders=function(r,c){var s=c._getVisibleStartHour(),e=c._getVisibleEndHour(),o=new Date(),h=c._getHoursFormat(),A=c._getAMPMFormat();r.write("<div");r.addClass("sapMSinglePCRowHeaders");r.writeClasses();r.write(">");for(var i=s;i<=e;i++){o.setHours(i);r.write("<span");r.addClass("sapMSinglePCRowHeader");r.addClass("sapMSinglePCRowHeader"+i);if(c._shouldHideRowHeader(i)){r.addClass("sapMSinglePCRowHeaderHidden");}r.writeClasses();r.write(">");r.write(h.format(o));if(c._hasAMPM()){r.write("<span");r.addClass("sapMSinglePCRowHeaderAMPM");r.writeClasses();r.write(">");r.write(" "+A.format(o));r.write("</span>");}r.write("</span>");}r.write("</div>");};S.renderColumns=function(r,c){var d=c._getColumns(),s=c.getStartDate(),A=c._getAppointmentsToRender();r.write("<div");r.writeAttribute("role","grid");r.writeAttribute("aria-labelledby",I.getStaticId("sap.m","SPC_APPOINTMENTS"));r.addClass("sapMSinglePCColumns");r.writeClasses();r.write(">");for(var i=0;i<d;i++){var o=new C(s.getFullYear(),s.getMonth(),s.getDate()+i),D=c._formatDayAsString(o);r.write("<div");r.writeAttribute("data-sap-day",D);r.addClass("sapMSinglePCColumn");if(o.isSame(new C())){r.addClass("sapMSinglePCColumnToday");}if(a._isWeekend(o,c._getCoreLocaleData())){r.addClass("sapMSinglePCColumnWeekend");}r.writeClasses();r.write(">");this.renderRows(r,c);this.renderAppointments(r,c,A[D],o);r.write("</div>");}r.write("</div>");};S.renderRows=function(r,c){var s=c._getVisibleStartHour(),e=c._getVisibleEndHour();for(var i=s;i<=e;i++){r.write("<div");r.addClass("sapMSinglePCRow");if(!c._isVisibleHour(i)){r.addClass("sapMSinglePCNonWorkingRow");}r.writeAttribute("data-sap-hour",i);r.writeClasses();r.write(">");r.write("</div>");}};S.renderAppointments=function(r,c,A,o){var t=this;if(A){r.write("<div");r.addClass("sapMSinglePCAppointments");r.addClass("sapUiCalendarRowVisFilled");r.writeClasses();r.write(">");A.oAppointmentsList.getIterator().forEach(function(d){var m=A.iMaxLevel,l=d.level,w=d.width,e=d.getData();t.renderAppointment(r,c,m,l,w,e,o);});r.write("</div>");}};S.renderAppointment=function(r,c,m,A,i,o,d){var R=c._getRowHeight(),e=new U(d.getYear(),d.getMonth(),d.getDate(),c._getVisibleStartHour()),f=new U(d.getYear(),d.getMonth(),d.getDate(),c._getVisibleEndHour(),59,59),g=o.getStartDate(),h=o.getEndDate(),t=o.getTooltip_AsString(),T=o.getType(),s=o.getColor(),j=o.getTitle(),k=o.getText(),l=o.getIcon(),n=o.getId(),p={role:"gridcell",labelledby:{value:I.getStaticId("sap.ui.unified","APPOINTMENT"),append:true}},q=c.getAriaLabelledBy(),v=e.getTime()>g.getTime(),w=f.getTime()<h.getTime(),x=v?0:c._calculateTopPosition(g),y=w?0:c._calculateBottomPosition(h),z=100/(m+1);if(q.length>0){p["labelledby"].value=p["labelledby"].value+" "+q.join(" ");}if(j){p["labelledby"].value=p["labelledby"].value+" "+n+"-Title";}p["labelledby"].value=p["labelledby"].value+" "+n+"-Descr";if(k){p["labelledby"].value=p["labelledby"].value+" "+n+"-Text";}if(o.getSelected()){p["labelledby"].value=p["labelledby"].value+" "+I.getStaticId("sap.ui.unified","APPOINTMENT_SELECTED");}if(o.getTentative()){p["labelledby"].value=p["labelledby"].value+" "+I.getStaticId("sap.ui.unified","APPOINTMENT_TENTATIVE");}r.write("<div");r.writeElementData(o);r.writeAttribute("data-sap-level",A);r.writeAttribute("data-sap-width",i);r.writeAttribute("tabindex",0);if(t){r.writeAttributeEscaped("title",t);}r.writeAccessibilityState(o,p);r.addClass("sapMSinglePCAppointmentWrap");r.addClass("sapUiCalendarRowApps");r.addStyle("top",x+"px");r.addStyle("bottom",y+"px");r.addStyle(sap.ui.getCore().getConfiguration().getRTL()?"right":"left",z*A+"%");r.addStyle("width",z*i+"%");r.writeClasses();r.writeStyles();r.write(">");r.write("<div");r.addClass("sapUiCalendarApp");r.addStyle("min-height",(R/2-1)+"px");if(o.getSelected()){r.addClass("sapUiCalendarAppSel");}if(o.getTentative()){r.addClass("sapUiCalendarAppTent");}if(l){r.addClass("sapUiCalendarAppWithIcon");}if(!s&&T&&T!=b.None){r.addClass("sapUiCalendarApp"+T);}if(s){if(sap.ui.getCore().getConfiguration().getRTL()){r.addStyle("border-right-color",s);}else{r.addStyle("border-left-color",s);}}r.writeClasses();r.writeStyles();r.write(">");r.write("<div");r.addClass("sapUiCalendarAppCont");if(s){r.addStyle("background-color",o._getCSSColorForBackground(s));r.writeStyles();}r.writeClasses();r.write(">");if(l){var B=["sapUiCalendarAppIcon"];var D={};D["id"]=n+"-Icon";D["title"]=null;r.writeIcon(l,B,D);}if(j){r.write("<span");r.writeAttribute("id",n+"-Title");r.addClass("sapUiCalendarAppTitle");r.writeClasses();r.write(">");r.writeEscaped(j,true);r.write("</span>");}if(k){r.write("<span");r.writeAttribute("id",n+"-Text");r.addClass("sapUiCalendarAppText");r.writeClasses();r.write(">");r.writeEscaped(k,true);r.write("</span>");}r.write("<span id=\""+n+"-Descr\" class=\"sapUiInvisibleText\">"+c._getAppointmentStartEndInfo(o)+"</span>");r.write("</div>");r.write("</div>");r.write("</div>");};S.renderNowMarker=function(r,c){var d=new Date();r.write("<div");r.writeAttribute("id",c.getId()+"-nowMarker");r.addStyle("top",c._calculateTopPosition(d)+"px");r.addClass("sapMSinglePCNowMarker");if(c._isOutsideVisibleHours(d.getHours())){r.addClass("sapMSinglePCNowMarkerHidden");}r.writeClasses();r.writeStyles();r.write(">");r.write("<span");r.writeAttribute("id",c.getId()+"-nowMarkerText");r.addClass("sapMSinglePCNowMarkerText");r.writeClasses();r.write(">");r.write(c._formatTimeAsString(d));if(c._hasAMPM()){r.write("<span");r.writeAttribute("id",c.getId()+"-nowMarkerAMPM");r.addClass("sapMSinglePCNowMarkerAMPM");r.writeClasses();r.write(">");r.write(c._addAMPM(d));r.write("</span>");}r.write("</span>");r.write("</div>");};return S;},true);
