/*
 * ! UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/base/ManagedObject','sap/ui/dt/ElementUtil'],function(M,E){"use strict";var a=M.extend("sap.ui.dt.ManagedObjectObserver",{metadata:{"abstract":true,library:"sap.ui.dt",properties:{},associations:{target:{type:"sap.ui.base.ManagedObject"}},events:{modified:{parameters:{type:"string",name:"string",value:"any",oldValue:"any",target:"sap.ui.core.Element"}},destroyed:{}}}});a.prototype.init=function(){this._fnFireModified=function(){this.fireModified();}.bind(this);};a.prototype.exit=function(){this.unobserve();delete this._fnFireModified;};a.prototype.setTarget=function(t){this.unobserve();this.setAssociation("target",t);var T=this.getTargetInstance();if(T){this.observe(T);}return this;};a.prototype.observe=function(t){var b=this;t.attachEvent("_change",this._fnFireModified,this);this._fnOriginalDestroy=t.destroy;t.destroy=function(){b.unobserve();var o=this.destroy.apply(this,arguments);b.fireDestroyed();return o;};this._fnOriginalBindProperty=t.bindProperty;t.bindProperty=function(){var o=b._fnOriginalBindProperty.apply(this,arguments);b.fireModified();return o;};this._fnOriginalUnBindProperty=t.unbindProperty;t.unbindProperty=function(){var o=b._fnOriginalUnBindProperty.apply(this,arguments);b.fireModified();return o;};this._fnOriginalBindAggregation=t.bindAggregation;t.bindAggregation=function(s){var o=b._fnOriginalBindAggregation.apply(this,arguments);b.fireModified();return o;};this._fnOriginalUnBindAggregation=t.unbindAggregation;t.unbindAggregation=function(s){var o=b._fnOriginalUnBindAggregation.apply(this,arguments);b.fireModified();return o;};this._fnOriginalSetParent=t.setParent;t.setParent=function(p,s,S){var f=false;if(!this._bInSetParent){f=true;this._bInSetParent=true;}var c=this.getParent();var o=b._fnOriginalSetParent.apply(this,arguments);if(f&&!this.__bSapUiDtSupressParentChangeEvent){this._bInSetParent=false;if(c!==p||s==="dependents"){b.fireModified({type:"setParent",value:p,oldValue:c,target:this});}}return o;};this._fnOriginalAddAggregation=t.addAggregation;t.addAggregation=function(s,o,S){b._bAddOrSetAggregationCall=true;var O=b._fnOriginalAddAggregation.apply(this,arguments);b.fireModified({type:"addOrSetAggregation",name:s,value:o,target:this});return O;};this._fnOriginalSetAggregation=t.setAggregation;t.setAggregation=function(s,o,S){b._bAddOrSetAggregationCall=true;var O=b._fnOriginalSetAggregation.apply(this,arguments);b.fireModified({type:"addOrSetAggregation",name:s,value:o,target:this});return O;};this._fnOriginalRemoveAggregation=t.removeAggregation;t.removeAggregation=function(s,o,S){b._bRemoveAggregationCall=true;var O=b._fnOriginalRemoveAggregation.apply(this,arguments);b.fireModified({type:"removeAggregation",name:s,value:o,target:this});return O;};this._fnOriginalInsertAggregation=t.insertAggregation;t.insertAggregation=function(s,o,i,S){b._bInsertAggregationCall=true;var O=b._fnOriginalInsertAggregation.apply(this,arguments);b.fireModified({type:"insertAggregation",name:s,value:o,target:this});return O;};this._fnOriginalRemoveAllAggregation=t.removeAllAggregation;t.removeAllAggregation=function(s,S){b._bRemoveAllAggregationCall=true;var r=this.getAggregation(s);var o=b._fnOriginalRemoveAllAggregation.apply(this,arguments);b.fireModified({type:"removeAllAggregation",name:s,value:r,target:this});return o;};this._fnOriginalDestroyAggregation=t.destroyAggregation;t.destroyAggregation=function(s,S){b._bDestroyAggregationCall=true;var r=this.getAggregation(s);var o=b._fnOriginalDestroyAggregation.apply(this,arguments);b.fireModified({type:"destroyAggregation",name:s,value:r,target:this});return o;};this._aOriginalAddMutators={};this._aOriginalInsertMutators={};this._aOriginalRemoveMutators={};this._aOriginalRemoveAllMutators={};this._aOriginalDestructors={};var A=t.getMetadata().getAllAggregations();Object.keys(A).forEach(function(s){var o=A[s];var _=t[o._sMutator];this._aOriginalAddMutators[o.name]=_;t[o._sMutator]=function(O){b._bAddOrSetAggregationCall=false;var v;v=_.apply(this,arguments);if(!b._bAddOrSetAggregationCall){b.fireModified({type:"addOrSetAggregation",name:o.name,value:O,target:this});}return v;};var c=t[o._sInsertMutator];this._aOriginalInsertMutators[o.name]=c;t[o._sInsertMutator]=function(O,i){b._bInsertAggregationCall=false;var v;v=c.apply(this,arguments);if(!b._bInsertAggregationCall){b.fireModified({type:"insertAggregation",name:o.name,value:O,target:this});}return v;};var d=t[o._sRemoveMutator];this._aOriginalRemoveMutators[o.name]=d;t[o._sRemoveMutator]=function(O,S){b._bRemoveAggregationCall=false;var v=d.apply(this,arguments);if(!b._bRemoveAggregationCall){b.fireModified({type:"removeAggregation",name:o.name,value:O,target:this});}return v;};var e=t[o._sRemoveAllMutator];this._aOriginalRemoveAllMutators[o.name]=e;t[o._sRemoveAllMutator]=function(S){b._bRemoveAllAggregationCall=false;var r=this.getAggregation(s);var O=e.apply(this,arguments);if(!b._bRemoveAllAggregationCall){b.fireModified({type:"removeAllAggregation",name:o.name,value:r,target:this});}return O;};var f=t[o._sDestructor];this._aOriginalDestructors[o.name]=f;t[o._sDestructor]=function(S){b._bDestroyAggregationCall=false;var r=this.getAggregation(s);var O=f.apply(this,arguments);if(!b._bDestroyAggregationCall){b.fireModified({type:"destroyAggregation",name:o.name,value:r,target:this});}return O;};},this);};a.prototype.unobserve=function(){var t=this.getTargetInstance();if(t){t.destroy=this._fnOriginalDestroy;t.bindProperty=this._fnOriginalBindProperty;t.unbindProperty=this._fnOriginalUnBindProperty;t.bindAggregation=this._fnOriginalBindAggregation;t.unbindAggregation=this._fnOriginalUnBindAggregation;t.setParent=this._fnOriginalSetParent;t.addAggregation=this._fnOriginalAddAggregation;t.removeAggregation=this._fnOriginalRemoveAggregation;t.insertAggregation=this._fnOriginalInsertAggregation;t.setAggregation=this._fnOriginalSetAggregation;t.removeAllAggregation=this._fnOriginalRemoveAllAggregation;t.destroyAggregation=this._fnOriginalDestroyAggregation;var A=t.getMetadata().getAllAggregations();Object.keys(A).forEach(function(s){var o=A[s];t[o._sMutator]=this._aOriginalAddMutators[o.name];t[o._sInsertMutator]=this._aOriginalInsertMutators[o.name];t[o._sRemoveMutator]=this._aOriginalRemoveMutators[o.name];t[o._sRemoveAllMutator]=this._aOriginalRemoveAllMutators[o.name];t[o._sDestructor]=this._aOriginalDestructors[o.name];},this);t.detachEvent("_change",this._fnFireModified,this);}delete this._fnOriginalDestroy;delete this._fnOriginalBindProperty;delete this._fnOriginalUnBindProperty;delete this._fnOriginalBindAggregation;delete this._fnOriginalUnBindAggregation;delete this._fnOriginalSetParent;delete this._fnOriginalAddAggregation;delete this._fnOriginalRemoveAggregation;delete this._fnOriginalInsertAggregation;delete this._fnOriginalSetAggregation;delete this._fnOriginalRemoveAllAggregations;delete this._fnOriginalDestroyAggregation;delete this._aOriginalAddMutators;delete this._aOriginalInsertMutators;delete this._aOriginalRemoveMutators;delete this._aOriginalRemoveAllMutators;delete this._aOriginalDestructors;};a.prototype.getTargetInstance=function(){return sap.ui.getCore().byId(this.getTarget());};return a;},true);
