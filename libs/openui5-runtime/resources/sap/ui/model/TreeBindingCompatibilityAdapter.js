/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/model/TreeBinding','sap/ui/model/ClientTreeBinding','sap/ui/model/ChangeReason','sap/ui/model/TreeBindingUtils'],function(q,T,C,a,b){"use strict";var c=function(B,t){var d=t;q.extend(B,{_init:function(e){this._bExpandFirstLevel=e;this.mContextInfo={};this._initContexts();if(e&&!this._bFirstLevelExpanded){this._expandFirstLevel();}},_initContexts:function(s){this.aContexts=this.getRootContexts(0,Number.MAX_VALUE);for(var i=0,l=this.aContexts.length;i<l;i++){var o=this._getContextInfo(this.aContexts[i]);this._setContextInfo({oContext:this.aContexts[i],iLevel:0,bExpanded:o?o.bExpanded:false});}if(this._bExpandFirstLevel&&!this._bFirstLevelExpanded){this._expandFirstLevel(s);}},_expandFirstLevel:function(s){var d=this;if(this.aContexts&&this.aContexts.length>0){q.each(this.aContexts.slice(),function(i,o){if(!s){d._loadChildContexts(o);}d._getContextInfo(o).bExpanded=true;});this._bFirstLevelExpanded=true;}},_fnFireFilter:B._fireFilter,_fireFilter:function(){this._fnFireFilter.apply(this,arguments);this._initContexts(true);this._restoreContexts(this.aContexts);},_fnFireChange:B._fireChange,_fireChange:function(){this._fnFireChange.apply(this,arguments);this._initContexts(true);this._restoreContexts(this.aContexts);},_restoreContexts:function(e){var d=this;var n=[];q.each(e.slice(),function(i,o){var f=d._getContextInfo(o);if(f&&f.bExpanded){n.push.apply(n,d._loadChildContexts(o));}});if(n.length>0){this._restoreContexts(n);}},_loadChildContexts:function(o){var e=this._getContextInfo(o);var I=q.inArray(o,this.aContexts);var n=this.getNodeContexts(o,0,Number.MAX_VALUE);for(var i=0,l=n.length;i<l;i++){this.aContexts.splice(I+i+1,0,n[i]);var f=this._getContextInfo(n[i]);this._setContextInfo({oParentContext:o,oContext:n[i],iLevel:e.iLevel+1,bExpanded:f?f.bExpanded:false});}return n;},_getContextInfo:function(o){return o?this.mContextInfo[o.getPath()]:undefined;},_setContextInfo:function(D){if(D&&D.oContext){this.mContextInfo[D.oContext.getPath()]=D;}},getLength:function(){return this.aContexts?this.aContexts.length:0;},getContexts:function(s,l){return this.aContexts.slice(s,s+l);},getNodes:function(s,l){var e=this.getContexts(s,s+l);var n=[];for(var i=0;i<e.length;i++){var o=this._getContextInfo(e[i])||{};var f=e[i];n.push({context:f,level:o.iLevel,parent:o.oParentContext,nodeState:{expanded:o.bExpanded,collapsed:!o.bExpanded,selected:false}});}return n;},hasChildren:function(){return true;},nodeHasChildren:function(){return true;},getContextByIndex:function(r){return this.aContexts[r];},getLevel:function(o){var e=this._getContextInfo(o);return e?e.iLevel:-1;},isExpanded:function(r){var o=this.getContextByIndex(r);var e=this._getContextInfo(o);return e?e.bExpanded:false;},expandContext:function(o){var e=this._getContextInfo(o);if(e&&!e.bExpanded){this.storeSelection();this._loadChildContexts(o);e.bExpanded=true;this._fireChange();this.restoreSelection();}},expand:function(r){this.expandContext(this.getContextByIndex(r));},collapseContext:function(o,s){var e=this._getContextInfo(o);if(e&&e.bExpanded){this.storeSelection();for(var i=this.aContexts.length-1;i>0;i--){if(this._getContextInfo(this.aContexts[i]).oParentContext===o){this.aContexts.splice(i,1);}}e.bExpanded=false;if(!s){this._fireChange();}this.restoreSelection();}},collapse:function(r){this.collapseContext(this.getContextByIndex(r));},collapseToLevel:function(l){if(!l||l<0){l=0;}var e=this.aContexts.slice();for(var i=e.length-1;i>=0;i--){var f=this.getLevel(e[i]);if(f!=-1&&f>=l){this.collapseContext(e[i],true);}}this._fireChange();},toggleContext:function(o){var e=this._getContextInfo(o);if(e){if(e.bExpanded){this.collapseContext(o);}else{this.expandContext(o);}}},toggleIndex:function(r){this.toggleContext(this.getContextByIndex(r));},storeSelection:function(){var s=d.getSelectedIndices();var S=[];q.each(s,function(i,v){S.push(d.getContextByIndex(v));});this._aSelectedContexts=S;},restoreSelection:function(){d.clearSelection();var _=this._aSelectedContexts;q.each(this.aContexts,function(i,o){if(q.inArray(o,_)>=0){d.addSelectionInterval(i,i);}});this._aSelectedContexts=undefined;},attachSelectionChanged:function(){return undefined;},clearSelection:function(){d._oSelection.clearSelection();},attachSort:function(){},detachSort:function(){}});B._init(t.getExpandFirstLevel());};return c;},true);
