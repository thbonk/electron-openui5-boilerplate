/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/dt/Plugin','sap/ui/fl/Utils','sap/ui/fl/registry/ChangeRegistry'],function(P,F,C){"use strict";var B=P.extend("sap.ui.rta.plugin.Plugin",{metadata:{"abstract":true,library:"sap.ui.rta",properties:{commandFactory:{type:"object",multiple:false}},events:{elementModified:{command:{type:"sap.ui.rta.command.BaseCommand"}}}}});B.prototype._isEditable=function(){};B.prototype._isEditableByPlugin=function(o){var p=this.getMetadata().getName();var a=o.getEditableByPlugins();return a.indexOf(p)>-1;};B.prototype.registerElementOverlay=function(o){if(this._isEditable(o)){this.addToPluginsList(o);}};B.prototype.deregisterElementOverlay=function(o){this.removeFromPluginsList(o);};B.prototype.hasStableId=function(o){if(!o){return false;}else if(!o.getDesignTimeMetadata()){return F.checkControlId(o.getElementInstance());}var s=false;var d=o.getDesignTimeMetadata();var e=o.getElementInstance();var g=d.getData().getStableElements;if(g){var S=g(e);var u=S?S.some(function(v){var c=v.id||v;if(!F.checkControlId(c,v.appComponent)){return true;}}):true;s=!u;}else{s=F.checkControlId(e);}return s;};B.prototype.getVariantManagementKey=function(o,e,c){var v;if(o.getVariantManagement&&this._hasVariantChangeHandler(c,e)){v=o.getVariantManagement();}return v;};B.prototype._hasVariantChangeHandler=function(c,e){var o=this._getChangeHandler(c,e);o.revertChange=true;return(o&&o.revertChange);};B.prototype.checkAggregationsOnSelf=function(o,a){var d=o.getDesignTimeMetadata();var e=o.getElementInstance();var i=false;var A=d.getAggregationAction(a,o.getElementInstance())[0];var c=A?A.changeType:null;var b=A&&A.changeOnRelevantContainer;if(b){e=o.getRelevantContainer();}if(c&&this.hasChangeHandler(c,e)){i=true;}return i;};B.prototype.removeFromPluginsList=function(o){o.removeEditableByPlugin(this.getMetadata().getName());if(!o.getEditableByPlugins().length){o.setEditable(false);}};B.prototype.addToPluginsList=function(o){o.addEditableByPlugin(this.getMetadata().getName());o.setEditable(true);};B.prototype.hasChangeHandler=function(c,e){return!!this._getChangeHandler(c,e);};B.prototype._getChangeHandler=function(c,e){var s=e.getMetadata().getName();var r=C.getInstance().getRegistryItems({controlType:s,changeTypeName:c,layer:this.getCommandFactory().getFlexSettings().layer});if(r&&r[s]&&r[s][c]){var R=r[s][c];return R.getChangeTypeMetadata().getChangeHandler();}return undefined;};return B;},true);
