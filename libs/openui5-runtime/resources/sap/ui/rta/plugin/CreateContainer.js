/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/rta/plugin/Plugin','sap/ui/fl/Utils','sap/ui/rta/Utils','sap/ui/dt/OverlayRegistry'],function(P,F,R,O){"use strict";var C=P.extend("sap.ui.rta.plugin.CreateContainer",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});C.prototype._isEditable=function(o,b){if(b===undefined||b===null){return this._isEditableCheck(o,false)||this._isEditableCheck(o,true);}else{return this._isEditableCheck(o,b);}};C.prototype._isEditableCheck=function(o,b){var e=false;var p=this._getParentOverlay(b,o);if(!p||!p.getParentElementOverlay()){return false;}e=this.checkAggregationsOnSelf(p,"createContainer");if(e){var a=F.getViewForControl(p.getElementInstance());return this.hasStableId(o)&&F.checkControlId(a);}else{return false;}};C.prototype._getParentOverlay=function(s,o){var p;if(s){p=o.getParentElementOverlay();}else{p=o;}return p;};C.prototype.getCreateAction=function(s,o){var p=this._getParentOverlay(s,o);var d=p.getDesignTimeMetadata();var a=d.getAggregationAction("createContainer",o.getElementInstance());return a[0];};C.prototype.isCreateAvailable=function(s,o){return this._isEditable(o,s);};C.prototype.isCreateEnabled=function(s,o){var a=this.getCreateAction(s,o);if(!a){return false;}if(a.isEnabled&&typeof a.isEnabled==="function"){var i=a.isEnabled;var p=this._getParentOverlay(s,o);return i.call(null,p.getElementInstance());}else{return true;}};C.prototype.getCreatedContainerOverlay=function(a,n){var i=n;if(a.getCreatedContainerId&&typeof a.getCreatedContainerId==="function"){var m=a.getCreatedContainerId;i=m.call(null,n);}return O.getOverlay(i);};C.prototype._determineIndex=function(p,s,a,g){return R.getIndex(p,s,a,g);};C.prototype._getText=function(a,e,d,t){if(!a){return t;}var c=d.getAggregationDescription(a.aggregation,e).singular;var T=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");return T.getText(t,c);};C.prototype.getCreateContainerText=function(s,o){var a=this.getCreateAction(s,o);var p=this._getParentOverlay(s,o);var d=p.getDesignTimeMetadata();var e=p.getElementInstance();var t="CTX_CREATE_CONTAINER";return this._getText(a,e,d,t);};C.prototype._getContainerTitle=function(a,e,d){var t="TITLE_CREATE_CONTAINER";return this._getText(a,e,d,t);};C.prototype.handleCreate=function(s,o){var a=this.getCreateAction(s,o);var p=this._getParentOverlay(s,o);var d=p.getDesignTimeMetadata();var t=p.getElementInstance();var v=F.getViewForControl(t);var S;if(s){S=o.getElementInstance();}var n=v.createId(jQuery.sap.uid());var g=d.getAggregation(a.aggregation).getIndex;var i=this._determineIndex(t,S,a.aggregation,g);var c=this.getCommandFactory().getCommandFor(t,"createContainer",{newControlId:n,label:this._getContainerTitle(a,t,d),index:i},d);this.fireElementModified({"command":c,"action":a,"newControlId":n});};return C;},true);
