/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/changeHandler/JsControlTreeModifier"],function(J){"use strict";var _;var R={startRecordingUndo:function(){_=[];},stopRecordingUndo:function(){var r=_;_=undefined;return r;},performUndo:function(u){while(u.length){var o=u.pop();this[o.name].apply(this,o.properties);}},_saveUndoOperation:function(f,p){if(_){_.push({name:f,properties:p});}},setVisible:function(c,v){var o=this.getVisible(c);var r=J.setVisible.apply(this,arguments);if(o!==this.getVisible(c)){this._saveUndoOperation("setVisible",[c,o]);}return r;},setStashed:function(c,s){var o;var C=c.getId();if(c.getVisible){o=!c.getVisible();}else{o=c.getStashed();}J.setStashed.apply(this,arguments);var S=sap.ui.getCore().byId(C);if(o!==s){this._saveUndoOperation("setStashed",[S,!s]);}},bindProperty:function(c,p,b){var o=c.getBindingInfo(p);var O;var m=c.getMetadata().getPropertyLikeSetting(p);if(m){var P=m._sGetter;O=c[P]();}J.bindProperty.apply(this,arguments);if(o){this._saveUndoOperation("bindProperty",[c,p,o]);}else{this._saveUndoOperation("unbindProperty",[c,p]);}if(O){this._saveUndoOperation("setProperty",[c,p,O]);}},unbindProperty:function(c,p){var o=c.getBindingInfo(p);J.unbindProperty.apply(this,arguments);if(o){this._saveUndoOperation("bindProperty",[c,p,o]);}},setProperty:function(c,p,P){var o;var m=c.getMetadata().getPropertyLikeSetting(p);if(m){var s=m._sGetter;o=c[s]();}var r=J.setProperty.apply(this,arguments);if(o!==P){this._saveUndoOperation("setProperty",[c,p,o]);}return r;},setPropertyBinding:function(c,p,P){var o;var m=c.getMetadata().getPropertyLikeSetting(p);if(m){var s=m._sGetter;o=c[s]();}J.setPropertyBinding.apply(this,arguments);if(o!==P){this._saveUndoOperation("setPropertyBinding",[c,p,o]);}},createControl:function(c,a,v,s){var e=this.bySelector(s,a);var r=J.createControl.apply(this,arguments);if(!e){var C=this.bySelector(s,a);this._saveUndoOperation("destroy",[C]);}return r;},destroy:function(c){if(c){c.destroy();}},insertAggregation:function(p,n,o,i){var O=J.getAggregation.call(this,p,n);J.insertAggregation.apply(this,arguments);if(p){if(p.getMetadata){var m=p.getMetadata();var a=m.getAllAggregations();if(a){var A=a[n];if(A){if(A.multiple){this._saveUndoOperation("removeAggregation",[p,n,o]);}else{this._saveUndoOperation("insertAggregation",[p,n,O]);}}}}}},removeAggregation:function(p,n,o){var O;var a;if(p&&o){a=J.getAggregation.call(this,p,n);if(a){a.some(function(e,i){if(e===o){O=i;return true;}});}}J.removeAggregation.apply(this,arguments);if(O||O===0){this._saveUndoOperation("insertAggregation",[p,n,o,O]);}},removeAllAggregation:function(p,n){var o=[];var a;if(p){a=J.getAggregation.call(this,p,n);}if(a&&a instanceof Array){o=a.slice();}else if(a&&a instanceof Object){o[0]=a;}J.removeAllAggregation(p,n);if(o){o.forEach(function(e){this._saveUndoOperation("insertAggregation",[p,n,e]);},this);}}};return jQuery.sap.extend(true,{},J,R);},true);
