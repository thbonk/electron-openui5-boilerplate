/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/base/ManagedObject','sap/ui/qunit/QUnitUtils','sap/ui/test/Opa5','sap/ui/Device'],function($,M,Q,O,D){"use strict";return M.extend("sap.ui.test.actions.Action",{metadata:{properties:{idSuffix:{type:"string"}},publicMethods:["executeOn"]},executeOn:function(){return true;},$:function(c){var f,a=this._getAdapter(c.getMetadata()),A=this.getIdSuffix()||a;if(A){f=c.$(A);}else{f=$(c.getFocusDomRef());}if(!f.length){var e="Control "+c+" has no dom representation idSuffix was "+A;$.sap.log.error(e,this._sLogPrefix);throw new Error(e);}else{$.sap.log.info("Found a domref for the Control "+c+" the action is going to be executed on the dom id"+f[0].id,this._sLogPrefix);}return f;},getUtils:function(){return O.getUtils()||Q;},init:function(){this.controlAdapters={};},_getAdapter:function(m){var a=this.controlAdapters[m.getName()];if(a){return a;}var p=m.getParent();if(p){return this._getAdapter(p);}return null;},_tryOrSimulateFocusin:function(d,c){var o=d[0];d.focus();var w=d.is(":focus");if(!w){$.sap.log.debug("Control "+c+" could not be focused - maybe you are debugging?",this._sLogPrefix);}if(!w){this._createAndDispatchFocusEvent("focusin",o);this._createAndDispatchFocusEvent("focus",o);this._createAndDispatchFocusEvent("activate",o);}},_simulateFocusout:function(d){this._createAndDispatchFocusEvent("focusout",d);this._createAndDispatchFocusEvent("blur",d);this._createAndDispatchFocusEvent("deactivate",d);},_createAndDispatchMouseEvent:function(n,d){var o=$(d).offset(),x=o.x,y=o.y;var m={bubbles:true,cancelable:true,identifier:1,pageX:x,pageY:y,clientX:x,clientY:y,screenX:x,screenY:y,target:d,radiusX:1,radiusY:1,rotationAngle:0,button:0,type:n};var a;if(D.browser.phantomJS||(D.browser.msie&&(D.browser.version<12))){a=document.createEvent("MouseEvent");a.initMouseEvent(n,true,true,window,0,m.screenX,m.screenY,m.clientX,m.clientY,false,false,false,false,m.button,d);}else{a=new MouseEvent(n,m);}d.dispatchEvent(a);},_createAndDispatchFocusEvent:function(n,d){var f;if(D.browser.phantomJS){f=document.createEvent("FocusEvent");f.initEvent(n,true,false);}else if(D.browser.msie&&(D.browser.version<12)){f=document.createEvent("FocusEvent");f.initFocusEvent(n,true,false,window,0,d);}else{f=new FocusEvent(n);}d.dispatchEvent(f);$.sap.log.info("Dispatched focus event: '"+n+"'",this._sLogPrefix);},_sLogPrefix:"sap.ui.test.actions"});},true);
