/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
(function(){"use strict";var f=[],s=[],t,r=/\w/;function b(i,B,n,q){if(B>=0){if(n){s[i].branchTracking[B].truthy+=1;}else{s[i].branchTracking[B].falsy+=1;}}if(q>=0){l(i,q);}return n;}function g(E,A,D){var V=parseInt(E.getAttribute(A));return V>0?V:D;}function a(){var S,q=document.getElementsByTagName("script"),i,n;for(i=0,n=q.length;i<n;i+=1){S=q[i];if(/BranchTracking.js$/.test(S.getAttribute("src"))){return S;}}}function c(i,n){var B=blanket.options("branchTracking"),q=false,D,w=f.length,x=i.inputFileName,y,z=i.inputFile,A;if(z.indexOf("// sap-ui-cover-browser msie")>=0){q=true;D=sap.ui.require("sap/ui/Device");if(D&&D.browser.msie){D=undefined;}}f.push(x);s[w]=_$blanket[x]=[];if(B){_$blanket[x].branchTracking=[];}_$blanket[x].source=z.split("\n");_$blanket[x].source.unshift("");A=""+falafel(z,{attachComment:q,comment:q,loc:true,range:true,source:z},v.bind(null,B,w,D));y=A.split("\n").length+1;if(y!==_$blanket[x].source.length){jQuery.sap.log.warning("Line length mismatch! "+_$blanket[x].source.length+" vs. "+y,x,"sap.ui.test.BranchTracking");}n(A);}function d(D,n){if(!("$ignored"in n)){if(n.parent&&d(D,n.parent)){n.$ignored=true;}else{n.$ignored=n.type==="BlockStatement"&&e(D,n);}}return n.$ignored;}function e(D,n){function i(q){return q.type==="Line"&&q.value===" sap-ui-cover-browser msie"&&!(D&&D.browser.msie);}return n.body[0]&&n.body[0].leadingComments&&n.body[0].leadingComments.some(i);}function l(i,n){s[i][n]+=1;}function v(B,i,D,n){var H=s[i],q=H.branchTracking,w=n.loc.start.line,x;function y(){n.update("blanket.$l("+i+", "+w+"); "+n.source());z();return true;}function z(){if(w in H){jQuery.sap.log.warning("Multiple statements on same line detected"+" â€“ minified code not supported! Line number "+w,f[i],"sap.ui.test.BranchTracking");}H[w]=0;}function A(){var E=n.loc.source.slice(n.left.range[1],n.right.range[0]);if(E[0]===")"){E=E.slice(1);}if(E.slice(-1)==="("){E=E.slice(0,-1);}return E;}if(D&&d(D,n)){return false;}switch(n.type){case"AssignmentExpression":case"ArrayExpression":case"BlockStatement":case"BinaryExpression":case"Block":case"CallExpression":case"CatchClause":case"DebuggerStatement":case"EmptyStatement":case"FunctionExpression":case"Identifier":case"Line":case"Literal":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"Program":case"Property":case"SequenceExpression":case"SwitchCase":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":case"VariableDeclarator":return false;case"ConditionalExpression":if(!B){return false;}n.test.update("blanket.$b("+i+", "+q.length+", "+n.test.source()+")");q.push({alternate:n.alternate.loc,consequent:n.consequent.loc,falsy:0,truthy:0});return true;case"ExpressionStatement":if(n.expression.type==="Literal"&&n.expression.value==="use strict"){return false;}case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":case"WithStatement":case"BreakStatement":case"ContinueStatement":case"FunctionDeclaration":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":return y(n);case"IfStatement":if(e(undefined,n.consequent)){B=false;}n.test.update("blanket.$b("+i+", "+(B?q.length:-1)+", "+n.test.source()+", "+w+")");z();if(B){q.push({alternate:(n.alternate||n.test).loc,consequent:n.consequent.loc,falsy:0,truthy:0});}return true;case"LogicalExpression":if(!B){return false;}if(n.operator==="||"||n.operator==="&&"){x="blanket.$b("+i+", "+q.length+", "+n.left.source()+") "+A()+" ("+n.right.source()+")";if(!r.test(n.loc.source[n.range[0]])){x=" "+x;}n.update(x);q.push({alternate:n.operator==="&&"?n.left.loc:n.right.loc,consequent:n.operator==="&&"?n.right.loc:n.left.loc,falsy:0,truthy:0});}return true;case"VariableDeclaration":if(n.parent.type==="ForInStatement"||n.parent.type==="ForStatement"){return false;}return y(n);case"LabeledStatement":default:throw new Error(n.source());}}function h(){var M={},i=[],n;QUnit.begin(function(D){n=D.modules.length;D.modules.forEach(function(q){M[q.name]=q;});});QUnit.moduleStart(function(q){i=i.concat(Object.keys(M).filter(function(w){return M[w].tests===q.tests;}));});return function(){return i.length<n?i:undefined;};}if(window.blanket){window._$blanket={};blanket.$b=b;blanket.$l=l;blanket.instrument=c;var G=h(),S=a(),L=g(S,"data-lines-of-context",3);t=Math.min(g(S,"data-threshold",0),100);sap.ui.require(["sap/ui/test/BlanketReporter"],function(B){blanket.options("reporter",B.bind(null,L,t,G));});}var I,C="sap.ui.base.SyncPromise",F={},m,N=0,T,u={};function j(n,q){var B,H=_$blanket[n.$currentFileName],w=F[n.$currentFileName],x;if(n.$oldHits){x=Object.keys(H).filter(function(i){return!(w&&w[i])&&H[i]===n.$oldHits[i];});q.notOk(x.length,"Some lines have not been covered by this module in isolation: "+x);}if(n.$oldBranchTracking){B=Object.keys(H.branchTracking).filter(function(i){return H.branchTracking[i].falsy===n.$oldBranchTracking[i].falsy||H.branchTracking[i].truthy===n.$oldBranchTracking[i].truthy;});q.notOk(B.length,"Some branches have not been fully covered by this module in isolation: "+B);}}function k(R){var i,n=Object.keys(u).length,M="Uncaught (in promise): "+n+" times\n",P;if(n){for(i in u){P=u[i];if(P.getResult()&&P.getResult().stack){M+=P.getResult().stack;}else{M+=P.getResult();}if(P.$error.stack){M+="\n>>> SyncPromise rejected with above reason...\n"+P.$error.stack.split("\n").slice(2).join("\n");}M+="\n\n";}u={};if(R){R(M);}else if(I){jQuery.sap.log.info("Clearing "+n+" uncaught promises",M,C);}}}function o(P,i){if(i){delete u[P.$id];if(I){jQuery.sap.log.info("Promise "+P.$id+" caught",Object.keys(u),C);}return;}P.$id=N++;P.$error=new Error();u[P.$id]=P;if(I){jQuery.sap.log.info("Promise "+P.$id+" rejected with "+P.getResult(),Object.keys(u),C);}}function p(i,H){var A,n,B,q;H=H||{};A=H.after||function(){};n=H.afterEach||function(){};B=H.before||function(){};q=H.beforeEach||function(){};H.after=function(w){if(window.blanket&&!T&&!this.__ignoreIsolatedCoverage__&&t>=100){j(this,w);}return A.apply(this,arguments);};H.afterEach=function(w){var x=k.bind(null,w.ok.bind(w,false));function y(E){x();throw E;}function z(R){if(R&&typeof R.then==="function"){return R.then(z,y);}x();return R;}try{return z(n.apply(this,arguments));}catch(E){y(E);}};H.before=function(w){var x;this.$currentFileName=jQuery.sap.getResourceName(w.test.module.name);x=window.blanket&&_$blanket[this.$currentFileName];if(x){this.$oldHits=x.slice();if(x.branchTracking){this.$oldBranchTracking=JSON.parse(JSON.stringify(x.branchTracking,["falsy","truthy"]));}}return B.apply(this,arguments);};H.beforeEach=function(w){k();return q.apply(this,arguments);};m(i,H);}if(QUnit.module!==p){m=QUnit.module.bind(QUnit);QUnit.module=p;sap.ui.require(["sap/base/Log","sap/base/util/UriParameters","sap/ui/base/SyncPromise"],function(i,U,n){I=i.isLoggable(i.Level.INFO,C);T=new U(window.location.href).get("testId");n.listener=o;});QUnit.begin(function(){var i,H;jQuery("#qunit-modulefilter-dropdown-list").css("max-height","none");jQuery("#qunit-modulefilter-dropdown").click(function(M){if(M.target.tagName==="LABEL"){setTimeout(function(){jQuery("#qunit-modulefilter-actions").children().first().click();});}});if(window.blanket){for(i in _$blanket){H=_$blanket[i];F[i]=H.slice();}}});}}());
