/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/base/Log','./library','sap/ui/core/Control','./FormattedTextViewRenderer','sap/ui/core/library','sap/base/security/sanitizeHTML'],function(L,l,C,F,c,s){"use strict";var A=c.AccessibleRole;var a=C.extend("sap.ui.commons.FormattedTextView",{metadata:{library:"sap.ui.commons",properties:{accessibleRole:{type:"sap.ui.core.AccessibleRole",group:"Accessibility",defaultValue:A.Document},htmlText:{type:"string",group:"Misc",defaultValue:""}},aggregations:{controls:{type:"sap.ui.core.Control",multiple:true,singularName:"control"}}}});a.prototype.init=function(){this._renderingRules={};this._renderingRules.ATTRIBS={'span::class':1,'div::class':1,'div::id':1,'span::id':1,'embed::data-index':1};this._renderingRules.ELEMENTS={'abbr':1,'acronym':1,'address':1,'blockquote':1,'br':1,'cite':1,'code':1,'dfn':1,'div':1,'em':1,'h1':1,'h2':1,'h3':1,'h4':1,'h5':1,'h6':1,'kbd':1,'p':1,'pre':1,'q':1,'samp':1,'strong':1,'span':1,'var':1,'dl':1,'dt':1,'dd':1,'ol':1,'ul':1,'li':1,'embed':1};};a.prototype.exit=function(){delete this._renderingRules;};a.prototype.hasControls=function(){var b=this.getAggregation("controls");return!!(b&&b.length>0);};var S=function(t,b){var d=/^[0-9]*$/;for(var i=0;i<b.length;i+=2){var e=t+"::"+b[i];if(this._renderingRules.ATTRIBS[e]){if(t==="embed"&&!(b[i+1].match(d))){return null;}}else{var w='<'+t+'> with attribute ['+b[i]+'="'+b[i+1]+'"] is not allowed and cut';L.warning(w,this);b[i+1]=null;}}return b;};var p=function(t,b){if(this._renderingRules.ELEMENTS[t]){return S.call(this,t,b);}else{var w='<'+t+'> is not allowed';L.warning(w,this);}};a.prototype.setHtmlText=function(t){var b=s(t,{tagPolicy:p.bind(this)});this.setProperty("htmlText",b);return this;};var f=function(b){if(this.hasControls()){this.removeAllAggregation("controls");}var I=Array.isArray(b);if(I&&b.length>0){for(var i=0;i<b.length;i++){this.addAggregation("controls",b[i],true);}this.invalidate();}};a.prototype.setContent=function(h,b){this.setHtmlText(h);f.call(this,b);};return a;});
