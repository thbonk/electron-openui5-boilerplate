/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/core/Element','sap/ui/model/Context','./library'],function(q,E,C,l){"use strict";var R=E.extend("sap.ui.table.Row",{metadata:{library:"sap.ui.table",defaultAggregation:"cells",aggregations:{cells:{type:"sap.ui.core.Control",multiple:true,singularName:"cell"},_rowAction:{type:"sap.ui.table.RowAction",multiple:false,visibility:"hidden"}}}});R.prototype.init=function(){this.initDomRefs();};R.prototype.exit=function(){this.initDomRefs();};R.prototype.getFocusInfo=function(){var t=this.getParent();return t?t.getFocusInfo():E.prototype.getFocusInfo.apply(this,arguments);};R.prototype.applyFocusInfo=function(f){var t=this.getParent();if(t){t.applyFocusInfo(f);}else{E.prototype.applyFocusInfo.apply(this,arguments);}return this;};R.prototype.initDomRefs=function(){this._mDomRefs={};};R.prototype.getIndex=function(){var t=this.getParent();if(t){var r=t.indexOfRow(this);var n=t.getFixedRowCount();if(n>0&&r<n){return r;}var N=t.getFixedBottomRowCount();var v=t.getVisibleRowCount();if(N>0&&r>=v-N){var b=t.getBinding("rows");if(b&&b.getLength()>=v){return b.getLength()-(v-r);}else{return r;}}var f=t.getFirstVisibleRow();return f+r;}return-1;};R.prototype.getDomRefs=function(j){var a;var k;if(j===true){a=q.sap.byId;k="jQuery";}else{a=q.sap.domById;k="dom";}if(!this._mDomRefs[k]){this._mDomRefs[k]={};var t=this.getParent();if(t){var r=t.indexOfRow(this);this._mDomRefs[k].rowSelector=a(t.getId()+"-rowsel"+r);this._mDomRefs[k].rowAction=a(t.getId()+"-rowact"+r);}this._mDomRefs[k].rowScrollPart=a(this.getId());this._mDomRefs[k].rowFixedPart=a(this.getId()+"-fixed");this._mDomRefs[k].rowSelectorText=a(this.getId()+"-rowselecttext");if(j===true){this._mDomRefs[k].row=this._mDomRefs[k].rowScrollPart;if(this._mDomRefs[k].rowFixedPart.length>0){this._mDomRefs[k].row=this._mDomRefs[k].row.add(this._mDomRefs[k].rowFixedPart);}else{this._mDomRefs[k].rowFixedPart=undefined;}if(this._mDomRefs[k].rowSelector&&this._mDomRefs[k].rowSelector.length>0){this._mDomRefs[k].row=this._mDomRefs[k].row.add(this._mDomRefs[k].rowSelector);}else{this._mDomRefs[k].rowSelector=undefined;}if(this._mDomRefs[k].rowAction&&this._mDomRefs[k].rowAction.length>0){this._mDomRefs[k].row=this._mDomRefs[k].row.add(this._mDomRefs[k].rowAction);}else{this._mDomRefs[k].rowAction=undefined;}}}return this._mDomRefs[k];};R.prototype._updateSelection=function(t,T,s){var i=t.isIndexSelected(this.getIndex());var d=this.getDomRefs(true);var S="rowSelect";if(i){S="rowDeselect";}if(d.rowSelector){d.rowSelector.attr("title",T.mouse[S]);}if(d.rowSelectorText){var a="";if(!(this._oNodeState&&this._oNodeState.sum)&&!this._bHasChildren){a=T.keyboard[S];}d.rowSelectorText.text(a);}var r=d.rowScrollPart;if(d.rowFixedPart){r=r.add(d.rowFixedPart);}if(s){r.attr("title",T.mouse[S]);}else{r.removeAttr("title");}if(d.row){d.row.toggleClass("sapUiTableRowSel",i);t._getAccExtension().updateAriaStateOfRow(this,d,i);}};R.prototype.setRowBindingContext=function(c,m,b){var n;if(c&&!(c instanceof C)){n=c;c=c.context;}var $=this.getDomRefs(true).row;this._bHidden=!c;$.toggleClass("sapUiTableRowHidden",this._bHidden);this._collectRenderingInformation(c,n,b);this.setBindingContext(c,m);};R.prototype.setBindingContext=function(c,m){var r=E.prototype.setBindingContext.call(this,c||null,m);this._updateTableCells(c);return r;};R.prototype._updateTableCells=function(c){var t=this.getParent();if(!t){return;}var a=this.getCells(),A=this.getIndex(),h=!!t._updateTableCell,o,T,H;for(var i=0;i<a.length;i++){o=a[i];H=!!o._updateTableCell;T=H||h?o.$().closest("td"):null;if(H){o._updateTableCell(o,c,T,A);}if(h){t._updateTableCell(o,c,T,A);}}};R.prototype._collectRenderingInformation=function(c,n,b){this._oNodeState=undefined;this._iLevel=0;this._bIsExpanded=false;this._bHasChildren=false;this._sTreeIconClass="";if(n){this._oNodeState=n.nodeState;this._iLevel=n.level;this._bIsExpanded=false;this._bHasChildren=false;this._sTreeIconClass="sapUiTableTreeIconLeaf";this._sGroupIconClass="";if(b){if(b.getLevel){this._bIsExpanded=b.isExpanded(this.getIndex());}else if(b.findNode){this._bIsExpanded=this&&this._oNodeState?this._oNodeState.expanded:false;}if(b.nodeHasChildren){if(this._oNodeState){this._bHasChildren=b.nodeHasChildren(n);}}else if(b.hasChildren){this._bHasChildren=b.hasChildren(c);}if(this._bHasChildren){this._sTreeIconClass=this._bIsExpanded?"sapUiTableTreeIconNodeOpen":"sapUiTableTreeIconNodeClosed";this._sGroupIconClass=this._bIsExpanded?"sapUiTableGroupIconOpen":"sapUiTableGroupIconClosed";}}}};R.prototype.destroy=function(){this.removeAllCells();return E.prototype.destroy.apply(this,arguments);};return R;});
