/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/fl/LrepConnector","sap/ui/fl/Cache","sap/ui/fl/Utils","sap/ui/base/EventProvider"],function(q,L,C,U,E){"use strict";var S=function(s){E.apply(this);if(!s){throw new Error("no flex settings provided");}if(!s.features){s.features={"addFields":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"addGroup":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"removeField":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"removeGroup":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"hideControl":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"unhideControl":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"stashControl":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"unstashControl":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"renameField":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"renameGroup":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"moveFields":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"moveGroups":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"moveElements":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"moveControls":["CUSTOMER","CUSTOMER_BASE","VENDOR"],"propertyChange":["CUSTOMER_BASE","VENDOR"],"propertyBindingChange":["CUSTOMER_BASE","VENDOR"]};}this._oSettings=s;this._hasMergeErrorOccured=false;};S.prototype=q.sap.newObject(E.prototype);S.events={flexibilityAdaptationButtonAllowedChanged:"flexibilityAdaptationButtonAllowedChanged",changeModeUpdated:"changeModeUpdated"};S._instances={};S._bFlexChangeMode=true;S._bFlexibilityAdaptationButtonAllowed=false;S._oEventProvider=new E();S.fireEvent=function(e,p){S._oEventProvider.fireEvent(e,p);};S.attachEvent=function(e,c){S._oEventProvider.attachEvent(e,c);};S.detachEvent=function(e,c){S._oEventProvider.detachEvent(e,c);};S.getInstance=function(c,p){if(S._instances[c]){return Promise.resolve(S._instances[c]);}return C.getChangesFillingCache(L.createConnector(),c,p).then(S._storeInstance.bind(S,c));};S._storeInstance=function(c,f){var s;if(f.changes&&f.changes.settings){s=new S(f.changes.settings);}else{s=new S({});}S._instances[c]=s;return s;};S.getInstanceOrUndef=function(c){var s;if(S._instances[c]){s=S._instances[c];}return s;};S.isFlexChangeMode=function(){var f=this._isFlexChangeModeFromUrl();if(f!==undefined){return f;}return S._bFlexChangeMode;};S._isFlexChangeModeFromUrl=function(){var f;var u=q.sap.getUriParameters();if(u&&u.mParams&&u.mParams['sap-ui-fl-changeMode']&&u.mParams['sap-ui-fl-changeMode'][0]){if(u.mParams['sap-ui-fl-changeMode'][0]==='true'){f=true;}else if(u.mParams['sap-ui-fl-changeMode'][0]==='false'){f=false;}}return f;};S.activateFlexChangeMode=function(){var f=true;S._setFlexChangeMode(f);};S.leaveFlexChangeMode=function(){var f=false;S._setFlexChangeMode(f);};S._setFlexChangeMode=function(f){if(S._bFlexChangeMode===f){return;}S._bFlexChangeMode=f;var p={bFlexChangeMode:f};S.fireEvent(S.events.changeModeUpdated,p);};S.isFlexibilityAdaptationButtonAllowed=function(){return S._bFlexibilityAdaptationButtonAllowed;};S.allowFlexibilityAdaptationButton=function(){var f=true;S.setFlexibilityAdaptationButtonAllowed(f);};S.disallowFlexibilityAdaptationButton=function(){var f=false;S.setFlexibilityAdaptationButtonAllowed(f);};S.setFlexibilityAdaptationButtonAllowed=function(f){if(S._bFlexibilityAdaptationButtonAllowed===f){return;}S._bFlexibilityAdaptationButtonAllowed=f;var p={bFlexibilityAdaptationButtonAllowed:f};S.fireEvent(S.events.flexibilityAdaptationButtonAllowedChanged,p);};S.prototype.isKeyUser=function(){var i=false;if(this._oSettings.isKeyUser){i=this._oSettings.isKeyUser;}return i;};S.prototype.isModelS=function(){var i=false;if(this._oSettings.isAtoAvailable){i=this._oSettings.isAtoAvailable;}return i;};S.prototype.isAtoEnabled=function(){var i=false;if(this._oSettings.isAtoEnabled){i=this._oSettings.isAtoEnabled;}return i;};S.prototype.isChangeTypeEnabled=function(c,a){if(!a){a='USER';}var i=false;if(!this._oSettings.features[c]){i=true;}else{var A=q.inArray(a,this._oSettings.features[c]);if(A<0){i=false;}else{i=true;}}return i;};S.prototype.isProductiveSystem=function(){var i=false;if(this._oSettings.isProductiveSystem){i=this._oSettings.isProductiveSystem;}return i;};S.prototype.setMergeErrorOccured=function(e){this._hasMergeErrorOccoured=e;};S.prototype.hasMergeErrorOccured=function(){return this._hasMergeErrorOccured;};return S;},true);
