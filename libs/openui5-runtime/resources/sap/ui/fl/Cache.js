/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/Utils"],function(U){"use strict";var C=function(){};C._isOn=true;C._entries={};C._switches={};C.getSwitches=function(){return C._switches;};C.isActive=function(){return C._isOn;};C.setActive=function(a){C._isOn=a;};C.getEntries=function(){return C._entries;};C.clearEntries=function(){C._entries={};};C.getEntry=function(c,a){if(!C._entries[c]){C._entries[c]={};}if(!C._entries[c][a]){C._entries[c][a]={file:{changes:{changes:[],contexts:[]}}};}return C._entries[c][a];};C.clearEntry=function(c,a){C.getEntry(c,a);C._entries[c][a]={};};C._deleteEntry=function(c,a){if(C._entries[c]&&C._entries[c][a]){delete C._entries[c][a];}if(jQuery.isEmptyObject(C._entries[c])){delete C._entries[c];}};C.getChangesFillingCache=function(l,c,p){if(!this.isActive()){return l.loadChanges(c,p);}var s=c.name;var a=c.appVersion||U.DEFAULT_APP_VERSION;var o=C.getEntry(s,a);if(o.promise){return o.promise;}if(p&&p.cacheKey==="<NO CHANGES>"){return Promise.resolve({changes:{changes:[],contexts:[]},componentClassName:s});}var b=l.loadChanges(c,p).then(function(m){if(m&&m.changes&&m.changes.settings&&m.changes.settings.switchedOnBusinessFunctions){m.changes.settings.switchedOnBusinessFunctions.forEach(function(v){C._switches[v]=true;});}o.file=m;return o.file;},function(e){C._deleteEntry(s,a);throw e;});o.promise=b;return b;};C._getChangeArray=function(c){var s=c.name;var a=c.appVersion||U.DEFAULT_APP_VERSION;var e=C.getEntry(s,a);return e.file.changes.changes;};C.addChange=function(c,o){var a=C._getChangeArray(c);if(!a){return;}a.push(o);};C.updateChange=function(c,o){var a=C._getChangeArray(c);if(!a){return;}for(var i=0;i<a.length;i++){if(a[i].fileName===o.fileName){a.splice(i,1,o);break;}}};C.deleteChange=function(c,o){var a=C._getChangeArray(c);if(!a){return;}for(var i=0;i<a.length;i++){if(a[i].fileName===o.fileName){a.splice(i,1);break;}}};return C;},true);
