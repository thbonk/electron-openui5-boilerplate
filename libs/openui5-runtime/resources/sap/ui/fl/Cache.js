/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/Utils"],function(U){"use strict";var C=function(){};C._isOn=true;C._entries={};C._switches={};C.getSwitches=function(){return C._switches;};C.isActive=function(){return C._isOn;};C.setActive=function(a){C._isOn=a;};C.getEntries=function(){return C._entries;};C.getChangesFillingCache=function(l,c,p){if(!this.isActive()){return l.loadChanges(c,p);}if(p&&p.cacheKey==="<NO CHANGES>"){return Promise.resolve({changes:{changes:[],contexts:[]},componentClassName:c,dummy:true});}var o=C._entries[c];if(!o){o=C._entries[c]={};}if(o.promise){return o.promise;}var a=l.loadChanges(c,p).then(function(m){if(o.file){U.log.error('sap.ui.fl.Cache: Cached changes for component '+c+' overwritten.');}if(m&&m.changes&&m.changes.settings&&m.changes.settings.switchedOnBusinessFunctions){m.changes.settings.switchedOnBusinessFunctions.forEach(function(v){C._switches[v]=true;});}o.file=m;return o.file;},function(e){delete o.promise;throw e;});o.promise=a;return a;};C._getChangeArray=function(c){var e=C._entries[c];if(e){if(e.file){return e.file.changes.changes;}}};C.addChange=function(c,o){var a=C._getChangeArray(c);if(!a){return;}a.push(o);};C.updateChange=function(c,o){var a=C._getChangeArray(c);if(!a){return;}for(var i=0;i<a.length;i++){if(a[i].fileName===o.fileName){a.splice(i,1,o);break;}}};C.deleteChange=function(c,o){var a=C._getChangeArray(c);if(!a){return;}for(var i=0;i<a.length;i++){if(a[i].fileName===o.fileName){a.splice(i,1);break;}}};return C;},true);
